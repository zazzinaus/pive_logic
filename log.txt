Unsloth 2024.9.post1 patched 32 layers with 32 QKV layers, 32 O layers and 32 MLP layers.
Using the `WANDB_DISABLED` environment variable is deprecated and will be removed in v5. Use the --report_to flag to control the integrations used for logging result (for instance --report_to none).
ðŸ¦¥ Unsloth: Will patch your computer to enable 2x faster free finetuning.
Formatted dataset saved to formatted_dataset.json
{'generated_fol_premises': 'âˆ€x (Declining(x) âŠ• UnableToAttend(x))\nâˆ€x (Declining(x) âŠ• (Â¬RejectingPerson(x) âˆ§ UnableToAttend(x)))\nâˆ€x (Declining(x) â†’ Â¬IgnoringInvitation(x))\nâˆ€x (Declining(x) â†’ Â¬PuttingAsideToDealWithLater(x))\nâˆ€x (Declining(x) â†’ KnowingWhetherYouWillBeThere(x))', 'generated_fol_conclusion': 'Declining(x) âˆ§ Polite(x)', 'gold_answer': "1 Don't ignore the invitation.2 Don't wait. 3 Be thankful. 4 Be honest. 5 Ask for a different time. 6 Don't over-explain. 7 Send something.t's simply a statement that you are unable to attend whatever you've been invited to.", 'example_id': 56498, 'nl_context': "Remember that declining an invitation doesn't mean you're rejecting the person who sent it to you.\nIt's simply a statement that you are unable to attend whatever you've been invited to.\nHere are some tips on how to turn down an invitation in the most polite way: 1  Don't ignore the invitation.\n2  Putting the invitation aside to deal with later isn't good for you or the person who sent it.\n3  She needs to know whether or not you'll be there", 'nl_question': 'how to politely turn down an invitation to visit someone out of town', 'prover_answer': 'Uncertain', 'prover_status': '', 'prover_error': '', 'refined_response': 'FOL premises: \nâˆ€x (Declining(x) âŠ• UnableToAttend(x))\nâˆ€x (Declining(x) âŠ• (Â¬RejectingPerson(x) âˆ§ UnableToAttend(x)))\nâˆ€x (Declining(x) â†’ Â¬IgnoringInvitation(x))\nâˆ€x (Declining(x) â†’ Â¬PuttingAsideToDealWithLater(x))\nâˆ€x (Declining(x) â†’ KnowingWhetherYouWillBeThere(x))\n\nFOL question: \nDeclining(x) âˆ§ Polite(x)', 'corrected_fol': '### FOL premises: \nâˆ€x (Declining(x) âˆ¨ UnableToAttend(x))\nâˆ€x (Declining(x) âˆ§ Â¬RejectingPerson(x))\nâˆ€x (Declining(x) âˆ§ Â¬IgnoringInvitation(x))\nâˆ€x (Declining(x) âˆ§ Â¬PuttingAsideToDealWithLater(x))\nâˆ€x (Declining(x) âˆ§ KnowingWhetherYouWillBeThere(x))\n\n### FOL question: \nDeclining(x) âˆ§ Polite(x)', 'text': "<|begin_of_text|>{\nUse the natuaral language and the first-order logic translation of contexts and question to answer the queries.\nAnswer only in Natural Language with the response and nothing else.\nYou are a helpful assistant.\n### Contexts: \nRemember that declining an invitation doesn't mean you're rejecting the person who sent it to you.\nIt's simply a statement that you are unable to attend whatever you've been invited to.\nHere are some tips on how to turn down an invitation in the most polite way: 1  Don't ignore the invitation.\n2  Putting the invitation aside to deal with later isn't good for you or the person who sent it.\n3  She needs to know whether or not you'll be there\n\n### FOL contexts translation: \nâˆ€x (Declining(x) âŠ• UnableToAttend(x))\nâˆ€x (Declining(x) âŠ• (Â¬RejectingPerson(x) âˆ§ UnableToAttend(x)))\nâˆ€x (Declining(x) â†’ Â¬IgnoringInvitation(x))\nâˆ€x (Declining(x) â†’ Â¬PuttingAsideToDealWithLater(x))\nâˆ€x (Declining(x) â†’ KnowingWhetherYouWillBeThere(x))\n\n### Question: \nhow to politely turn down an invitation to visit someone out of town\n\n### FOL question traslation: \nDeclining(x) âˆ§ Polite(x)\n\n### Answer:\n}\n    "}
==((====))==  Unsloth 2024.9.post1: Fast Llama patching. Transformers = 4.44.2.
   \\   /|    GPU: NVIDIA GeForce RTX 3090. Max memory: 23.684 GB. Platform = Linux.
O^O/ \_/ \    Pytorch: 2.4.0+cu121. CUDA = 8.6. CUDA Toolkit = 12.1.
\        /    Bfloat16 = TRUE. FA [Xformers = 0.0.27.post2. FA2 = False]
 "-____-"     Free Apache license: http://github.com/unslothai/unsloth
Map:   0%|          | 0/300 [00:00<?, ? examples/s]Map: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 300/300 [00:00<00:00, 5284.56 examples/s]
Detected kernel version 5.4.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
max_steps is given, it will override any value given in num_train_epochs
==((====))==  Unsloth - 2x faster free finetuning | Num GPUs = 1
   \\   /|    Num examples = 300 | Num Epochs = 1
O^O/ \_/ \    Batch size per device = 2 | Gradient Accumulation steps = 4
\        /    Total batch size = 8 | Total steps = 2
 "-____-"     Number of trainable parameters = 41,943,040
GPU = NVIDIA GeForce RTX 3090. Max memory = 23.684 GB.
5.984 GB of memory reserved.
  0%|          | 0/2 [00:00<?, ?it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 1/2 [00:05<00:05,  5.40s/it]                                              50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 1/2 [00:05<00:05,  5.40s/it]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2/2 [00:07<00:00,  3.71s/it]                                             100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2/2 [00:07<00:00,  3.71s/it]                                             100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2/2 [00:08<00:00,  3.71s/it]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2/2 [00:08<00:00,  4.48s/it]
{'loss': 1.9264, 'grad_norm': 0.5269385576248169, 'learning_rate': 5e-06, 'epoch': 0.03}
{'loss': 2.3195, 'grad_norm': 0.5952273607254028, 'learning_rate': 1e-05, 'epoch': 0.05}
{'train_runtime': 8.9702, 'train_samples_per_second': 1.784, 'train_steps_per_second': 0.223, 'train_loss': 2.122967302799225, 'epoch': 0.05}
8.9702 seconds used for training.
0.15 minutes used for training.
Peak reserved memory = 6.91 GB.
Peak reserved memory for training = 0.926 GB.
Peak reserved memory % of max memory = 29.176 %.
Peak reserved memory for training % of max memory = 3.91 %.
